# gravity_wave_detection
## What is Gravity Wave and what is our purpose in this work?
Atmospheric gravity waves are a type of wave that occurs in the Earth's atmosphere caused by interplay between gravity and buoyancy forces. Atmospheric phenomena such as, global circulation and air turbulence are due to the presence of gravity waves. These waves have profound impacts on various aspects of the atmosphere, including the patterns of precipitation, cloud formation, ozone distribution, aerosols, pollutant dispersion etc. Therefore, understanding gravity waves is essential for comprehending and monitoring changes in a wide range of atmospheric behaviors. Limited studies have been conducted to identify gravity waves from satellite data using machine learning techniques. Particularly, without the need for noise removal, remains an underexplored area of research. This study presents a novel kernel design aimed at identifying gravity waves within satellite images. The proposed kernel is seamlessly integrated into the proposed deep neural network, denoted as \textbf{gWaveNet}. Our proposed model exhibits exceptional proficiency in detecting images containing gravity waves from noisy satellite data without any feature engineering. The empirical results prove the effectiveness of our proposed model with training accuracy exceeding 98\% and testing accuracy close to 94\%.

## Data
For this investigation, we used the Day/Night Band (DNB) images from the Visible Infrared Imaging Radiometer Suite (VIIRS) instrument onboard the Suomi NPP satellite \cite{gravity_wave_data}. VIIRS DNB observes board band upwelling radiance in the visible region. VIIRS DNB has a wide swath ($\sim$3000 km) and a relatively high spatial resolution at 1 km approximately. Pixels within a 6-minute granule ($\sim$4000x3000 pixels) are stored in a  Hierarchical Data Format version-5 (HDF5) \cite{hdf5}. The raw HDF5 files contain radiance measurements within the wavelength range of $0.5\mu m$ to $0.9\mu m$. To highlight the airglow from gravity wave events, nighttime images under new moon conditions are used in this study. As a result, the DNB radiance could be extremely low with a value in the order of magnitude of $-10^{-9}$W/$cm^{-2}$$sr^{-1}$. To comprehend easily, we performed preprocessing on the raw data, ensuring that the array values are within a specific range while maintaining their relative distribution \cite{gonzalez2022atmospheric}. This involved subtracting the minimum value from all array elements, scaling by the median, and normalizing to 0.5. Normalizing to this reference point enables easier visual comparison and analysis of the data. Finally, we transformed the intensity distribution from an approximate normal distribution to a uniform one, while preserving the accurate range of values. These measurements were collected in twelve 1000x1000 pixels, as shown in Figure \ref{fig:prep}. Figure \ref{fig:gwngw} is an example of images with and without gravity waves.

## Proposed Network
First, we present \textit{gWaveNet}, a hybrid neural network architecture that combines both trainable and non-trainable layers. Next, we introduce a unique kernel specifically designed to detect various shapes within our data. This kernel plays a crucial role in our methodology. Notably, we integrate the kernel into the initial layer of \textit{gWaveNet}, effectively incorporating its capabilities into the overall model.

Our proposed \textit{gWaveNet} is a deep convolutional network that has 15 layers that comprise 6 convolutional layers, 6 max-pooling layers, 2 dense layers, and 1 dropout layer (Figure~\ref{fig:model}). The model is designed for binary classification tasks on grayscale images. We integrated the proposed kernels in the first layer making it either trainable or non-trainable, followed by alternating convolutional and max-pooling layers, which successively extract features and reduce spatial dimensions. L2 regularization is applied in the second convolutional layer to reduce any overfitting caused by the custom kernel in the first layer. After the final max-pooling layer, the output tensor is flattened, and the data passes through a dense layer, a dropout layer, and a final sigmoid-activated dense layer for binary classification.

Since our dataset contains excessive noise including the horizontal lines, we designed the kernel in such a way that can capture all types of gravity wave shapes excluding the horizontal lines. We used the kernel in the first layer of our proposed deep-learning model motivated by the Laplacian filter, to generate low-level features from input grayscale images. The first layer of the model is configured both as trainable and non-trainable to validate its effectiveness for generating domain-specific features from the dataset.

## Emperical Evaluation
In this section, we describe the extensive experiments and its evaluation with customizing the layers of the model, getting the right regularizer, optimization, and loss function in following subsections.

### Experimental Setup
For our experimental evaluation, we use the gravity wave dataset assigned to either gravity wave or non-gravity wave classes. The performance of the proposed model is compared with three state-of-the-art approaches. Our proposed model is implemented using Keras 2.11 and TensorFlow 2. To train and test the proposed model and baseline models we used a GPU machine with 20GB RAM. Most of the models are trained for 2,000 epochs with a batch size of 128 on the training dataset. Where the training and validation dataset is split into 65:35 ratio, and 240 patches for testing only. Specifically, the models trained with FFT denoised data and the gWaveNet model without the custom kernel were trained for an extended number of epochs (2500 and 3000, respectively) to evaluate if longer training improves their performance. The hyper-parameters of each baseline method are kept intact to experiment with our data.   
%\vspace*{-3mm}

### Evaluation Metrics
To compare the performance of baseline models with our proposed model different evaluation metrics were used such as overall detection accuracy, the area under the curve, precision, recall, and $F1$ score~\cite{eval2021}. The $F1$ score is computed using the precision and recall values of the testing dataset. The overall accuracy of the model is measured from the detection accuracy of each individual gravity weave instance detected from the test images.

### Optimization and Loss Function
Our proposed model aims to differentiate between gravity wave images and noisy non-gravity wave images. To achieve this, we utilize the binary cross entropy loss function to calculate the detection loss during the model's training process. The stochastic gradient descent (SGD) method with the binary cross entropy loss objective function is used to optimize our proposed model. SGD \cite{sun2019survey} is a commonly used optimization method in deep learning to train on large datasets. Instead of calculating the gradient from the entire dataset, SGD estimates gradients using a smaller batch of data, reducing the complexity of gradient calculation. Although SGD has a common feature of gradient fluctuations due to batch gradient updates, it provides a better chance of finding the global optimal solution for complex problems \cite{wilson2017marginal}. This optimization process resulted in a smooth learning trend and generalized feature learning in the model.


<!-- comment
`
# Table of Contents
 >> ### 1. [What is Ocean Eddy?](https://github.com/big-data-lab-umbc/aws-automation/tree/main/gpu-example/OceanEddy#:~:text=README.md-,What%20is%20Ocean%20Eddy%3F,-The%20term%20eddy)
 >> ### 2. [SageMaker based Configuration](https://github.com/big-data-lab-umbc/aws-automation/tree/main/gpu-example/OceanEddy#:~:text=Configuring%20SageMaker%20for%20Ocean%20Eddy%20classification%20model)
 >> ### 3. [EC2 based Configuration](https://github.com/big-data-lab-umbc/aws-automation/tree/main/gpu-example/OceanEddy#3-configuring-ec2-for-ocean-eddy-classification-model:~:text=3.%20Configuring%20EC2%20for%20Ocean%20Eddy%20classification%20model)
`
 -->

![text-here](./images/4.png)
